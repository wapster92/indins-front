# Блоки страниц

* [Базовый блок страницы (PageBlock)](#pageblock)
* [Блок табов (TabsBlock)](#tabsblock)
* [Блок комментариев (DynamicComments)](#dynamiccomments)
* [Блок автосохранения (AutoSaveBlock)](#autosaveblock)
* [Блок-аккордеон (AccordeonBlock)](#accordeonblock)

[Вернуться к содержанию](/README.md#содержание)

## PageBlock
Блок для отображения информации в карточках сущности вне попапов. В идеале из таких блоков строится вся страница.

### Свойства:
* **value** (Boolean) - свойство для корректной работы v-model. Скрывает содержимое блока, если равно true. По-умолчанию равно false.
* **title** (String) - заголовок блока (отображается в левой верхней его части). Если передано, показывает верхнюю часть блока, даже если не указано свойство show-top. По-умолчанию равно ''.
* **show-top** (Boolean) - показывает верхнюю часть блока, в которой находятся заголовок (если он указан), кнопки, переданные через слот buttons, и кнопка сворачивания, если allow-minimize свойство равно true. По-умолчанию равно false.
* **no-padding** (Boolean) - убирает дефолтные паддинги в блоке с содержимым компонента. По-умолчанию равно false.
* **no-content** (Boolean) - скрывает блок с содержимым, даже если там что-то есть. По-умолчанию равно false.
* **transparent-content** (Boolean) - делает фон блока с содержимым прозрачным. По-умолчанию равно false - фон белый.
* **allow-minimize** (Boolean) - показывает кнопку сворачивания содержимого блока, если верхняя часть компонента видна (передано свойство title или show-top). По-умолчанию равно false.

### Слоты:
* **default** - слот для содержимого блока. Содержимое слота видно только если не передано свойство *no-content*.
* **buttons** - слот для кнопок в верхней части блока. Содержимое слота видно только если видно верхнюю часть блока.

> Блок можно использовать несколькими способами:
> Показывать только заголовок в случае, когда блоков с содержимым будет
> несколько и они выводятся на основе массива.
```
<PageBlock title="Информация об операциях" no-content />
<PageBlock
  v-for="operation in operations"
  :key="'operation-' + operation.id"
>
<!-- Содержимое блоков -->
</PageBlock>
```
> Обычным способом.
```
<PageBlock title="Основная информация">
<!-- Содержимое -->
</PageBlock>
```
> Разворачиваемый блок.
```
<PageBlock
  v-model="isEmpty"
  title="Основная информация"
  allow-minimize
>
<!-- Содержимое -->
<!-- Если не нужно позволять пользователю разворчивать блок самостоятельно, -->
<!-- то allow-minimize передавать не нужно. -->
<!-- isEmpty - что в вашем компоненте, что опеределяет, что блок пуст -->
</PageBlock>
```

## TabsBlock
Блок для отображения табов. Работает в режиме ссылок и в режиме блока.

### Свойства:
* **value** (String, Number) - свойство для работы v-model для связи компонента с компонентом v-tabs-items вьютифая. Также можно использовать, чтобы в изначальном состоянии компонент отображал не первый таб. По-умолчанию равно 0.
* **color** (String) - свойство, изменяющее цвет компонента (плавающая полоска и эффекты наведения). По-умолчанию равно '' - в этом случае будет использован дефолтный цвет системы.
* **tabs** (Array) - свойство для предоставления информации о кнопках-табах. По-умолчанию равно []. Передается в следующем формате:
* **block-mode** (Boolean) - включать ли блочный режим. В блочном режиме под табами появляется белый блок с рамкой (используется компонент PageBock), в котором будет отображено содержимое слота по-умолчанию. По-умолчанию равно false.
* **block-props** (Object) - свойство для передачи настроек в PageBlock, которые используется для отображения содержимого табов. Передавайте туда те же свойства, что и в компонент PageBlock. По-умолчанию равно {}.
* **allow-content** (Boolean) - альтернатива block-mode - но не оборачивает содержимое в PageBlock. Игнорируется, если используется block-mode. По-умолчанию равно false.
* **content-classes** (String) - список css классов, которые надо передать на обертку содержимого. Передается и на PageBlock в блочном режиме и на обычный див в другом режиме. Передавать также, как в class атрибут html элементов. По-умолчанию равно ''.
```
[
    {
        title: 'Отображаемое название таба',
        key: 'ключ таба для корректной работы в блочном режиме',
        nuxt: true/false, // заменить nuxt-link компонентом.
        to: '/users/3' || { name: 'users-id', params: { id: 3 } }, // роут, на который ведет ссылка.
    }
]
```
> **Не обязательно использовать tabs свойство**.
> Вместо этого можно воспользоваться слотом tabs, в который передать
> компоненты v-tab. Это зависит исключительно от предпочтений.
```
<template #tabs>
  <v-tab
    :to="{ name: 'appearance-inputs-fields' }"
    nuxt
  >
    Первая подстраница
  </v-tab>
  <v-tab
    :to="{ name: 'appearance-inputs-subform' }"
    nuxt
  >
    Вторая подстраница
  </v-tab>
</template>
```

### Слоты:
* **default** - слот для контента компонента. Содержимое слота будет видно только в блочном режиме.
* **tabs** - слот для табов компонента, если свойство tabs не дает что-либо сделать.


## DynamicComments
Блок для отображения табов. Работает в режиме ссылок и в режиме блока.

### Свойства:
* **title** (String) - заголовок блока. Если указан, то над комментариями появляется плашка с названием (как в PageBlock). По-умолчанию равно ''.
* **list** (Array) - список комментариев, которые необходимо отобразить в блоке. Свойство игнорируется, если указать свойство query. По-умолчанию равно [].
* **query** (Object, String) - запрос, который необходимо сделать, чтобы получить список комментариев. Передавайте в это свойство то же, что передаете в new Get() конструктор из core-xhr. Он же будет использоваться для создания новых комментариев. Если не указать, панель добавления комментариев будет скрыта. По-умолчанию равно ''.
* **add-query** (Object, String, null) - запрос, которые отправляется при отправке сообщения в блоке. Принимает объект Post из core-xhr или строку, которая будет передана в его конструктор. Свойства *attach-field* и *attach-id* используются для того, чтобы связывать новый комментарий с сущностью, так что никаких лишних данных самому не нужно записывать. Если свойство не указано, вместо него будет использовано свойство *query* (при этом, даже если туда передали Get запрос, ключ из него будет использован для создания Post запроса). По-умолчанию равно null.
* **attach-field** (String) - поле сущности комментария, в котором находится сущность, с которой необходимо связывать любой созданный в этом блоке комментарий (поддерживаются только связи ManyToOne и OneToOne). Необходимо использовать в паре с attach-id. Можно указывать значения через точку, если вложенностей больше 1. По-умолчанию равно ''.
* **attach-id** (String, Number) - id сущности, с которой будет связан комментарий. По-умолчанию равно ''.
* **author-field** (String) - поле сущности комментария, из которого брать информацию об авторе комментария. Можно передавать поля через точку. По-умолчанию равно 'user'.
* **file-upload** (Boolean) - свойство включает загрузку файлов, которые прикрепляются к комментариям. Поддерживается только связь OneToMany. По-умолчанию равно false.
* **files-field** (String) - поле сущности комментария, из которого брать информацию о файлах, прикрепленных к комментарию. Имеет смысл указывать только если включено свойство file-upload. По-умолчанию равно 'commentFiles'.
* **subscribe** (String, Array) - список сущностей, на которые необходимо подписаться. При обновлении сущностей список комментариев будет запрашиваться снова. Можно передать одну сущность в виде строки - нужно только ее название с большой буквы. Также можно передать массив таких же строк, если сущностей несколько. По-умолчанию равно [].
* **readonly** (Boolean) - свойство, скрывающее панель добавления комментариев, даже если query указан.
* **allow-deleted** (Boolean) - если свойство передано, запрос на получение комментариев улетит без фильтра deletedAt = false. По-умолчанию равно false.
* **custom-get-request** (Function) - если для получения комментариев необходимо сделать кастомный запрос, передайте это свойство. По-умолчанию равно null.
* **allow-minimize** (Boolean) - показывает кнопку сворачивания содержимого блока, если верхняя часть компонента видна (передано свойство title). По-умолчанию равно false.
* **is-minimized** (Boolean) - свойство, с помощью которого можно управлять сворачиванием блока. Работает с .sync модификатором (информация о нем в доках Vue). По-умолчанию равно false.
* **max-field-height** (String, Number) (добавлено с 4.0.1) - максимальная высота поля ввода комментария. Измеряется в пикселях. По-умолчанию 0 - при этом значении максимальная высота игнорируется.

### События:
* **send-comment** (Object) - событие, вызываемое только когда *query* и *add-query* свойства не были переданы и было отправлено сообщение. Передает объект вида: { text: 'Текст комментария', files: []}, где files - это массив объектов загруженных на сервер файлов. Используйте для кастомной отправки сообщений.

### Слоты:
* **replace-avatar** - слот заменяющий аватар автора комментария на содержимое слота. Экспортирует свойства:
> *initials* (String) - получившиеся инициалы, на основе информации об авторе.
> *photo* (String) - ссылка на аватар пользователя, если он есть.
* **comment-buttons** - слот для кнопок, которые появляются внутри каждого комментария. Экспортирует свойства:
> *item* (Object) - сущность комментария.
> *edit-comment* (Function) - метод, который необходимо вызвать, чтобы показать форму редактирования комментария. Форма будет отображена только если не используется слот replace-comment - в этом случае подобную форму необходимо делать самостоятельно. 
> *stop-editting-comment* (Function) - метод, который необходимо вызвать, чтобы прекратить редактирование комментария в компоненте.
> *edited-comment* (Object, null) - редактируемый в данный момент комментарий. null, если ни один из комментариев не редактируется.
* **additional-block** - дополнительный блок, который появляется между комментариями и полем для их отправления.
* **field** - слот для поля ввода комментариев в нижней части блока комментариев. Экспортирует свойства:
> *comment* (String) - введенный текст нового комментария.
> *input* (Function) - функция для записи comment пропы внутри компонента. Первым аргументом получает записываемое значение.
* **replace-comment** - слот для замены содержимого элемента комментария. На случай, когда список собирается из разных сущностей и в зависимости от сущности элемент списка выглядит по другому. Экспортирует свойства:
> *item* (Object) - сущность комментария(?).
> *edit-comment* (Function) - метод, который необходимо вызвать, чтобы поменить комментарий как редактируемый в данный момент.
> *stop-editting-comment* (Function) - метод, который необходимо вызвать, чтобы прекратить редактирование комментария в компоненте.
> *edited-comment* (Object, null) - редактируемый в данный момент комментарий. null, если ни один из комментариев не редактируется.


## AutoSaveBlock
**(Не рекомендуется к использованию - вместо него необходимо использовать метод в [сторе](/src/store#панель-автосохранения))**
Блок для автоматического сохранения форм. Вся его суть только в том, чтобы предоставить метод, вызывающий функцию для сохранения данных.

### Свойства:
* **background-color** (String) - цвет всплывающего блока с кнопками. По-умолчанию равно '#ffffff'.
* **border** (Boolean) - свойство, определяющее, оборачивать ли всплывающий блок в рамку. По-умолчанию равно false.
* **fixed** (Boolean) - свойство, применяющее css-свойство position: fixed к всплывающему блоку. Использовать, чтобы блок занимал весь низ экрана. По-умолчанию равно false.
* **sticky** (Boolean) - свойства, применяющее css-свойство position: sticky к всплывающему блоку. По-умолчанию равно false.
* **no-padding** (Boolean) - свойство, убирающее паддинги у всплывающего блока. По-умолчанию равно false.
* **save-by-timeout** (Boolean) - свойство, позволяющее вызывать функцию сохранения без лишних кликов - всплывающий блок к этом случае не появляется при вызове throttledSave. Сохранение произойдет через кол-во миллисекунд, указанное в свойстве *timeout*. По-умолчанию равно false.
* **timeout** (Number) - свойство, отвечающее за задержку перед появлением всплывающего блока после вызова throttledSave. если передано свойство *save-by-timeout*, вместо отображения попапа вызывается событие *save*. По-умолчанию равно 2000 (в миллисекундах).
* **no-scroll** (Boolean) - выключает компонент скролла, который добавляется в обертку дефолтного слота. По-умолчанию равно false.

### Слоты:
* **default** - слот необходим для корректной работы компонента. В этом слоте должна находиться форма, которая будет вызывать экспортируемый метод

## AccordeonBlock
Обертка, скрывающая часть своего содержимого - функционал скрытия/раскрытия прописан внутри.

### Свойства:
* *expand-at-start* (Boolean) - свойство, определяющее показывать ли скрытое содержимое при первой отрисовке компонента. По-умолчанию равно false.
* *max-content-height* (String, Number) - свойство, для ограничения высоты скрытого содержимого. По-умолчанию равно 0 - ограничений нет.
* *value* (Boolean) - свойство для корректной работы v-model. Отвечает за раскрытие/скрытие содержимого. По-умолчанию равно false.

### Слоты:
* *top* - слот для всего, что необходимо показывать всегда, справа от кнопки раскрытия аккордеона.
* *buttons* - слот для кнопок, которе необходимо показать справа от содержимого слота top, но слева от кнопки раскрытия аккордеона.
* *default* - слот для скрываемого содержимого компонента.
